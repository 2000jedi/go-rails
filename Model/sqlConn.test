package Model

import (
	"database/sql"
	"fmt"
)

func Count_test() {
	print(database.count("test"))
}

func Table_test() {
	fmt.Println(Cast(tables["test"].all().v[1][1]))
}

var tables map[string]*TableType

func init() {
	database.connect("main.sqlite")
	tables = make(map[string]*TableType)

	tables["test"] = &TableType{}
	tables["test"].name = "test"
	tables["test"].v = []CellStruct{{"hello", INT}, {"date", DATETIME}}
	tables["test"].query = func(rows *sql.Rows) (t Table) {
		t.m = *tables["test"]
		var tabledata [][]Cell

		defer rows.Close()
		for rows.Next() {
			tabulardata := []Cell{{"hello", INT, nil}, {"date", DATETIME, nil}}
			err := rows.Scan(&tabulardata[0].data, &tabulardata[1].data)
			checkErrorDB(err)
			tabledata = append(tabledata, tabulardata)
		}
		t.v = tabledata
		return t
	}
}
